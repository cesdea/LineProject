<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GameTeller · AI</title>
  <!-- 메인 스타일 (사용자가 제공한 main.css) -->
  <link rel="stylesheet" href="./assets/css/main.css" />
  <!-- Markdown 렌더링 (업로더 예제와 동일) -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <style>
    /* 페이지 전용 보조 스타일 (main.css와 충돌 없이 보완) */
    body.page-ai { background: radial-gradient(1000px 600px at 70% 30%, #0b1020 0%, #0a0f1a 55%, #05070d 100%); }

    .site-header .brand { color:#d8e9ff; }
    .site-header { border-bottom: 1px solid rgba(120,160,255,.18); background: rgba(11,16,32,.65); backdrop-filter: blur(8px); }

    /* 히어로 내부 텍스트 대비 */
    .hero-full .site { color:#eaf2ff; }
    .hero-full .sub { color:#bcd3ff; }

    /* AI 채팅 레이아웃 */
    .ai-wrap { display:grid; grid-template-columns: 320px 1fr; gap: var(--sp-6); align-items: start; margin: 28px 0 48px; }
    .ai-side { position: sticky; top: 96px; align-self: start; }
    .ai-side .card { background: rgba(10,15,26,.6); border:1px solid rgba(120,160,255,.15); color:#eaf2ff; }

    .chatbox.card { background: rgba(10,15,26,.6); border:1px solid rgba(120,160,255,.15); color:#eaf2ff; padding: 0; overflow: hidden; }
    .chatbox header { display:flex; align-items:center; justify-content:space-between; padding: 12px 14px; border-bottom:1px solid rgba(120,160,255,.18); }
    .chatbox header .title { font-weight: 700; }

    .chat-log { padding: 14px; max-height: min(62vh, 680px); overflow: auto; display:flex; flex-direction: column; gap: 12px; }
    .bubble { border-radius: 18px; padding: 10px 12px; width: fit-content; max-width: 92%; box-shadow: 0 12px 24px rgba(0,0,0,.25); }
    .bubble.me { margin-left: auto; background: #2b6cb0; color:#fff; }
    .bubble.ai { background: rgba(120,160,255,.12); color:#eaf2ff; border:1px solid rgba(120,160,255,.18); }

    .chat-input { display:flex; gap: 8px; padding: 10px; border-top:1px solid rgba(120,160,255,.18); background: rgba(8,11,20,.85); }
    .chat-input input[type="text"], .chat-input textarea {
      flex: 1; min-height: 48px; max-height: 160px; padding: 12px; border-radius: 14px; border:1px solid rgba(160,190,255,.25);
      background:#0a0f1a; color:#d8e9ff; outline: none; resize: vertical;
    }
    .chat-input input:focus, .chat-input textarea:focus { border-color: rgba(120,170,255,.6); box-shadow: 0 0 0 3px rgba(120,170,255,.18); }

    .toolbar { display:flex; flex-wrap: wrap; gap: 8px; align-items:center; padding: 10px 14px; border-top:1px solid rgba(120,160,255,.18); background: rgba(8,11,20,.85); }
    .toolbar .seg { display:inline-flex; border:1px solid rgba(120,160,255,.25); border-radius: 999px; overflow: hidden; }
    .toolbar .seg button { border:0; background: transparent; padding:8px 12px; color:#bcd3ff; cursor:pointer; }
    .toolbar .seg button.active { background: rgba(120,160,255,.15); color:#eaf2ff; }
    .toolbar label { display:inline-flex; align-items:center; gap:6px; color:#bcd3ff; }

    .note { font-size: 12px; color:#9eb6d9; opacity:.9; }

    /* 반응형 */
    @media (max-width: 1024px) {
      .ai-wrap { grid-template-columns: 1fr; }
      .ai-side { position: static; }
    }

        /* 로딩 애니메이션 */
    .bubble.ai.loading {
      display: inline-flex;
      gap: 4px;
      background: rgba(120,160,255,.12);
      border: 1px solid rgba(120,160,255,.18);
    }

    .bubble.ai.loading .dot {
      width: 8px;
      height: 8px;
      background: #bcd3ff;
      border-radius: 50%;
      opacity: 0.5;
      animation: dotPulse 1.2s infinite ease-in-out;
    }

    .bubble.ai.loading .dot:nth-child(1){ animation-delay: 0s; }
    .bubble.ai.loading .dot:nth-child(2){ animation-delay: 0.2s; }
    .bubble.ai.loading .dot:nth-child(3){ animation-delay: 0.4s; }

    @keyframes dotPulse {
      0%, 80%, 100% { opacity: .3; transform: scale(.7); }
      40% { opacity: 1; transform: scale(1); }
    }
  </style>
</head>

<body class="page-ai">
  <!-- 공통 헤더 -->
  <header class="site-header">
    <div class="header-inner container">
      <div class="brand">GameTeller</div>
      <nav class="nav"></nav>
      <div class="header-actions">
        <a href="./index.html" class="back-btn">← 메인으로</a>
      </div>
    </div>
  </header>

  <!-- 풀스크린 히어로 (main.css 의 .hero-full,.overlay 재사용) -->
  <section class="hero-full">
    <div class="bg">
      <!-- 필요 시 이미지 교체 -->
      <img src="https://images.unsplash.com/photo-1550745165-9bc0b252726f?q=80&w=1920&auto=format&fit=crop" alt="neon game bg" loading="lazy" />
    </div>

    <!-- 부드러운 플로팅 아이콘 데코 (선택) -->
    <div class="icon-field" aria-hidden="true">
      <img class="icon" style="--xp:18; --yp:32; --size:72px; --dxv: 3vw; --ampv:1.2vh; --rot:6deg; --duration:16s; --delay:0s;" src="https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/svg/1f3ae.svg" alt="🎮" />
      <img class="icon" style="--xp:72; --yp:24; --size:60px; --dxv: 2.5vw; --ampv:1vh; --rot:5deg; --duration:18s; --delay:.6s;" src="https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/svg/2728.svg" alt="✨" />
      <img class="icon" style="--xp:84; --yp:68; --size:64px; --dxv: 3.4vw; --ampv:1.4vh; --rot:7deg; --duration:19s; --delay:.2s;" src="https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/svg/1f680.svg" alt="🚀" />
    </div>

    <!-- 카피 & 액션 -->
    <div class="overlay">
      <div class="hero-content">
        <h1 class="site">GameTeller AI</h1>
        <p class="sub">게임 추천·공략·뉴스 요약, 하나의 AI로 해결하세요.</p>
        <a class="btn primary" href="#ai">지금 사용해보기</a>
        <a class="btn ghost" href="#how">사용 가이드</a>
      </div>
    </div>
  </section>

  <main id="ai" class="container ai-wrap">
    <!-- 좌측 사이드: 프리셋/가이드 -->
    <aside class="ai-side">
      <article class="card">
        <h3 class="section-title">빠른 시작</h3>
        <div class="chips">
          <button class="btn ghost" data-prompt="요즘 인기 협동 게임 3개 추천해줘. 각 장르/플랫폼/난이도 포함">인기 협동 게임</button>
          <button class="btn ghost" data-prompt="엘든 링 초반 빌드 가이드 요약. 초보자 팁 5개 포함">공략 요약</button>
          <button class="btn ghost" data-prompt="메타크리틱 85점 이상 인디게임 Top5 리스트업">인디 Top5</button>
        </div>
        <p class="note" id="how">Tip) 프롬프트는 구체적으로. 목적·대상·형식을 함께 적으면 더 좋아요.</p>
      </article>
      <article class="card">
        <h3 class="section-title">모델/모드</h3>
        <div class="toolbar">
          <div class="seg" role="tablist" aria-label="Response mode">
            <button type="button" class="active" data-mode="fast">빠른</button>
            <button type="button" data-mode="precise">정밀</button>
          </div>
          <label><input type="checkbox" id="streamToggle" /> 스트리밍</label>
        </div>
        <p class="note">스트리밍 켜면 답변이 한 줄씩 실시간 표시됩니다.</p>
      </article>
    </aside>

    <!-- 우측: 채팅 박스 -->
    <section class="chatbox card" aria-live="polite">
      <header>
        <span class="title">GameTeller AI 어시스턴트</span>
        <button class="btn ghost" type="button" id="clearBtn">대화 지우기</button>
      </header>

      <div id="aiLog" class="chat-log" aria-label="Conversation"></div>

      <div class="toolbar">
        <div class="seg" role="tablist" aria-label="Output format">
          <button type="button" class="active" data-format="markdown">Markdown</button>
          <button type="button" data-format="plain">텍스트</button>
        </div>
        <span class="note">* 키 관리는 서버 프록시 권장. 데모 목적의 클라이언트 호출입니다.</span>
      </div>

      <form id="aiForm" class="chat-input" autocomplete="off">
        <textarea id="aiInput" rows="2" placeholder="무엇을 도와드릴까요? (예: 10월에 할만한 스팀 신작 추천)" required></textarea>
        <button class="btn primary" type="submit">보내기</button>
      </form>
    </section>
  </main>

  <section class="container zone" style="margin-bottom:80px">
    <h3 class="section-title">개발자 참고</h3>
    <div class="card">
      <ul>
        <li>Non-Streaming: <code>models:generateContent</code> 호출</li>
        <li>Streaming: <code>models:streamGenerateContent</code> 호출</li>
        <li>Markdown 렌더링은 <code>marked</code> 사용</li>
      </ul>
      <p class="note">실서비스에서는 <strong>API 키를 클라이언트에 두지 마세요</strong>. 간단한 Node/Express 프록시를 사용해 서버 사이드에서 키를 보호하세요.</p>
    </div>
  </section>

    <!-- ✅ 설정: 전역(window)에 등록 -->
  <script>
    window.CONFIG = {
      MODEL_FAST: 'gemini-2.5-flash',
      MODEL_PRECISE: 'gemini-2.0-pro-exp-02-05',
      API_KEY: 'AIzaSyBSGbThI7csEQHvELcYpb32DP-cNZV3cR8',
      BASE: 'https://generativelanguage.googleapis.com/v1beta/models/'
    };
  </script>

  <!-- ✅ 외부 JS 로직 로드: 반드시 CONFIG 아래에 -->
  <script src="./assets/js/ai.js"></script>
  <script src="./assets/js/app.js"></script>

</body>
</html>
